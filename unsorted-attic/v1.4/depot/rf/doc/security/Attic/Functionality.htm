<html xmlns:v="urn:schemas-microsoft-com:vml"
xmlns:o="urn:schemas-microsoft-com:office:office"
xmlns:w="urn:schemas-microsoft-com:office:word"
xmlns="http://www.w3.org/TR/REC-html40">

<head>
<meta http-equiv=Content-Type content="text/html; charset=windows-1252">
<meta name=ProgId content=Word.Document>
<meta name=Generator content="Microsoft Word 9">
<meta name=Originator content="Microsoft Word 9">
<link rel=File-List href="./Functionality_files/filelist.xml">
<link rel=Edit-Time-Data href="./Functionality_files/editdata.mso">
<!--[if !mso]>
<style>
v\:* {behavior:url(#default#VML);}
o\:* {behavior:url(#default#VML);}
w\:* {behavior:url(#default#VML);}
.shape {behavior:url(#default#VML);}
</style>
<![endif]-->
<title>BB Security Functionality</title>
<!--[if gte mso 9]><xml>
 <o:DocumentProperties>
  <o:Author>pramila</o:Author>
  <o:Template>Normal</o:Template>
  <o:LastAuthor>pramila</o:LastAuthor>
  <o:Revision>2</o:Revision>
  <o:TotalTime>11840</o:TotalTime>
  <o:LastPrinted>2002-07-24T17:46:00Z</o:LastPrinted>
  <o:Created>2002-07-25T18:39:00Z</o:Created>
  <o:LastSaved>2002-07-25T18:39:00Z</o:LastSaved>
  <o:Pages>16</o:Pages>
  <o:Words>4531</o:Words>
  <o:Characters>25827</o:Characters>
  <o:Company>RouteFree</o:Company>
  <o:Lines>215</o:Lines>
  <o:Paragraphs>51</o:Paragraphs>
  <o:CharactersWithSpaces>31717</o:CharactersWithSpaces>
  <o:Version>9.3821</o:Version>
 </o:DocumentProperties>
</xml><![endif]-->
<style>
<!--
 /* Font Definitions */
@font-face
	{font-family:Wingdings;
	panose-1:5 0 0 0 0 0 0 0 0 0;
	mso-font-charset:2;
	mso-generic-font-family:auto;
	mso-font-pitch:variable;
	mso-font-signature:0 268435456 0 0 -2147483648 0;}
 /* Style Definitions */
p.MsoNormal, li.MsoNormal, div.MsoNormal
	{mso-style-parent:"";
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";}
h1
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:1;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-font-kerning:0pt;}
h2
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:2;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-weight:normal;
	font-style:italic;}
h3
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:3;
	font-size:14.0pt;
	mso-bidi-font-size:12.0pt;
	font-family:"Times New Roman";
	font-style:italic;}
h4
	{mso-style-next:Normal;
	margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	page-break-after:avoid;
	mso-outline-level:4;
	font-size:12.0pt;
	font-family:"Times New Roman";
	font-style:italic;}
p.MsoBodyText, li.MsoBodyText, div.MsoBodyText
	{margin:0in;
	margin-bottom:.0001pt;
	mso-pagination:widow-orphan;
	font-size:12.0pt;
	font-family:"Times New Roman";
	mso-fareast-font-family:"Times New Roman";
	font-weight:bold;}
@page Section1
	{size:8.5in 11.0in;
	margin:1.0in 1.25in 1.0in 1.25in;
	mso-header-margin:.5in;
	mso-footer-margin:.5in;
	mso-paper-source:0;}
div.Section1
	{page:Section1;}
 /* List Definitions */
@list l0
	{mso-list-id:20135686;
	mso-list-type:hybrid;
	mso-list-template-ids:385237752 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l0:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l1
	{mso-list-id:112797363;
	mso-list-type:hybrid;
	mso-list-template-ids:-1572018892 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l1:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.75in;
	mso-level-number-position:left;
	margin-left:.75in;
	text-indent:-.25in;
	font-family:Symbol;}
@list l2
	{mso-list-id:213083066;
	mso-list-type:hybrid;
	mso-list-template-ids:1322407300 67698691 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l2:level1
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l3
	{mso-list-id:257955234;
	mso-list-type:hybrid;
	mso-list-template-ids:1384384524 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l3:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l4
	{mso-list-id:361589888;
	mso-list-type:hybrid;
	mso-list-template-ids:-1825031506 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l4:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l5
	{mso-list-id:382600525;
	mso-list-type:hybrid;
	mso-list-template-ids:-232382176 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l5:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l6
	{mso-list-id:500655981;
	mso-list-type:hybrid;
	mso-list-template-ids:-151196678 67698691 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l6:level1
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l7
	{mso-list-id:608850518;
	mso-list-type:hybrid;
	mso-list-template-ids:-128534756 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l7:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l8
	{mso-list-id:694498447;
	mso-list-type:hybrid;
	mso-list-template-ids:314311960 67698691 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l8:level1
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l9
	{mso-list-id:754015937;
	mso-list-type:hybrid;
	mso-list-template-ids:-1703908862 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l9:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l10
	{mso-list-id:760218841;
	mso-list-type:hybrid;
	mso-list-template-ids:1110475106 67698689 67698691 67698689 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l10:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l10:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l10:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l10:level4
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:2.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l11
	{mso-list-id:803275549;
	mso-list-type:hybrid;
	mso-list-template-ids:1325316688 67698691 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l11:level1
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l12
	{mso-list-id:922572602;
	mso-list-type:hybrid;
	mso-list-template-ids:686183140 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l12:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l13
	{mso-list-id:1073964288;
	mso-list-type:hybrid;
	mso-list-template-ids:-662533550 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l13:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l14
	{mso-list-id:1073969291;
	mso-list-type:hybrid;
	mso-list-template-ids:1940263150 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l14:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l15
	{mso-list-id:1088311505;
	mso-list-type:hybrid;
	mso-list-template-ids:1277701758 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l15:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l16
	{mso-list-id:1125849821;
	mso-list-type:hybrid;
	mso-list-template-ids:1766358962 1876060508 1594284262 -1489761640 -1100315366 -1224288036 -94848168 -785484572 -781020604 -1185268264;}
@list l16:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:Symbol;}
@list l16:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	mso-ansi-font-size:10.0pt;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l17
	{mso-list-id:1267232571;
	mso-list-type:hybrid;
	mso-list-template-ids:2401674 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l17:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l18
	{mso-list-id:1282372620;
	mso-list-type:hybrid;
	mso-list-template-ids:1967949172 67698691 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l18:level1
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l19
	{mso-list-id:1492332242;
	mso-list-type:hybrid;
	mso-list-template-ids:-1347631310 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l19:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l20
	{mso-list-id:1500316293;
	mso-list-type:hybrid;
	mso-list-template-ids:-1513295582 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l20:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l21
	{mso-list-id:1571888804;
	mso-list-type:hybrid;
	mso-list-template-ids:1216012026 67698689 67698691 67698689 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l21:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l21:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l21:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l22
	{mso-list-id:1630284091;
	mso-list-type:hybrid;
	mso-list-template-ids:-291735356 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l22:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l23
	{mso-list-id:1652170152;
	mso-list-type:hybrid;
	mso-list-template-ids:-597934548 67698689 67698691 67698689 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l23:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l23:level2
	{mso-level-number-format:bullet;
	mso-level-text:o;
	mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:"Courier New";
	mso-bidi-font-family:"Times New Roman";}
@list l23:level3
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:1.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l24
	{mso-list-id:1714190087;
	mso-list-type:hybrid;
	mso-list-template-ids:510803160 67698703 67698713 67698715 67698703 67698713 67698715 67698703 67698713 67698715;}
@list l24:level1
	{mso-level-tab-stop:1.25in;
	mso-level-number-position:left;
	margin-left:1.25in;
	text-indent:-.25in;}
@list l25
	{mso-list-id:1826047588;
	mso-list-type:hybrid;
	mso-list-template-ids:314311960 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l25:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l26
	{mso-list-id:1966426960;
	mso-list-type:hybrid;
	mso-list-template-ids:-265285944 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l26:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l27
	{mso-list-id:1975407646;
	mso-list-type:hybrid;
	mso-list-template-ids:2063128346 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l27:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l28
	{mso-list-id:1991790874;
	mso-list-type:hybrid;
	mso-list-template-ids:239760940 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l28:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:38.7pt;
	mso-level-number-position:left;
	margin-left:38.7pt;
	text-indent:-.25in;
	font-family:Symbol;}
@list l29
	{mso-list-id:2050110488;
	mso-list-type:hybrid;
	mso-list-template-ids:-1794185250 67698689 67698703 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l29:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
@list l29:level2
	{mso-level-tab-stop:1.0in;
	mso-level-number-position:left;
	text-indent:-.25in;}
@list l30
	{mso-list-id:2116628892;
	mso-list-type:hybrid;
	mso-list-template-ids:-340759906 67698689 67698691 67698693 67698689 67698691 67698693 67698689 67698691 67698693;}
@list l30:level1
	{mso-level-number-format:bullet;
	mso-level-text:\F0B7;
	mso-level-tab-stop:.5in;
	mso-level-number-position:left;
	text-indent:-.25in;
	font-family:Symbol;}
ol
	{margin-bottom:0in;}
ul
	{margin-bottom:0in;}
-->
</style>
<!--[if gte mso 9]><xml>
 <o:shapedefaults v:ext="edit" spidmax="2050"/>
</xml><![endif]--><!--[if gte mso 9]><xml>
 <o:shapelayout v:ext="edit">
  <o:idmap v:ext="edit" data="1"/>
 </o:shapelayout></xml><![endif]-->
</head>

<body lang=EN-US style='tab-interval:.5in'>

<div class=Section1>

<h1><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt'>BB Security
Functionality<o:p></o:p></span></h1>

<p class=MsoNormal>The main security functionality is implemented at the server
and the BB player. The communication through the depots takes place through a
protocol that uses the underlying implementations on the server and the player.
The depot is secured by means of a third party secure card or token. This
document describes the functional level requirements of the secure operations
and design of the security library, not at the protocol level.</p>

<p class=MsoNormal>The following secure operations are described below:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l27 level1 lfo1;tab-stops:list .5in'>Download
     and personalization of content</li>
 <li class=MsoNormal style='mso-list:l27 level1 lfo1;tab-stops:list .5in'>Download
     of license from license server</li>
 <li class=MsoNormal style='mso-list:l27 level1 lfo1;tab-stops:list .5in'>Playback
     of content</li>
</ul>

<p class=MsoNormal>A few related operations are covered briefly for clarity.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The server code is all assumed secure. The player is secure
in secure mode, where all this functionality is implemented. </p>

<p class=MsoNormal>First we enumerate the basic security software primitives
and describe the various secure operations in terms of how they are implemented
using these primitives.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><b><i><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt'>Section
0: Introduction<o:p></o:p></span></i></b></p>

<p class=MsoNormal>The introduction lists basic security primitives available,
followed by important data structures.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h3><span style='font-size:12.0pt;font-style:normal'>Security Library
Primitives<o:p></o:p></span></h3>

<p class=MsoNormal>The following are the primitives implemented in the security
library are available as function calls for applications. The exact definition
of the API will be the well documented security_library.h code <span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>J</span></span>
(It will be linked to from here for reference). The following definition is for
reference from the description. Lower level functions that are not exposed are
mentioned here only for clarity.</p>

<p class=MsoNormal>The convention is that the output will be the last argument
and error/status will be the returned value. In this document, exact C syntax
is not used, but structure names will be used. Please see the next section on
the detailed structure of the security functions.</p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<h4>SECURE KERNEL WRAPPER API DEFINITION</h4>

<p class=MsoNormal>This layer is provided for current and future applications
to utilize the crypto functionality on the chip to run secure applications. It
exposes only public quantities, and any private quantities are encrypted, and
will be decrypted and used internal to the chip. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt'>This section is
TBD<o:p></o:p></span></i></h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><b>Rough listing of functions available for reference from
the following section on secure operations</b>:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>IsReEncryptRequired(license,
     boolean result) (this merely checks if boot length is same as content
     size: see license data structure fields below)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>GetBBID()</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>SignData(data,
     length, signed_data, length_of_signed_data)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>LaunchApplication(license_ptr)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>VerifyLicense(license_ptr)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>InitReEncryption(license_ptr)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>ReEncryptContent(content_ptr)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>VerifySignature(data_ptr,
     signature, certificate)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>ComputeSharedSecret(&amp;secret_encrypted_packet,
     certificate)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>AESEncrypt(secret_encrypted_packet,
     data_block)</li>
 <li class=MsoNormal style='mso-list:l13 level1 lfo29;tab-stops:list .5in'>AESDecrypt(secret_encypted_packet,
     data_block) (software decrypt)</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>(The last four are mostly for third party application
use…TBD).</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Unexposed functionality referred to in the following
description are:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l29 level1 lfo30;tab-stops:list .5in'>ECDSASign(data,
     private_key)</li>
 <li class=MsoNormal style='mso-list:l29 level1 lfo30;tab-stops:list .5in'>AESEncrypt(),
     AESDecrypt(), SHA-1()</li>
 <li class=MsoNormal style='mso-list:l29 level1 lfo30;tab-stops:list .5in'>ECDHSharedKey(public_key,
     private_key, shared_key)</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Note: Public key encryption to send data from A-&gt;B<span
style="mso-spacerun: yes">  </span>includes the following steps:</p>

<ul style='margin-top:0in' type=disc>
 <ol style='margin-top:0in' start=1 type=1>
  <li class=MsoNormal style='mso-list:l29 level2 lfo30;tab-stops:list 1.0in'>Compute
      a shared secret using ECDHSharedKey() with A’s private key and B’s public
      key.</li>
  <li class=MsoNormal style='mso-list:l29 level2 lfo30;tab-stops:list 1.0in'>Call
      AESEncrypt() with that key.</li>
 </ol>
</ul>

<p class=MsoNormal>To decrypt, B does:</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l24 level1 lfo31;
tab-stops:list 1.25in'><![if !supportLists]>1.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Compute the same shared secret using ECDHSharedKey() with B’s
private key and A’s public key</p>

<p class=MsoNormal style='margin-left:1.25in;text-indent:-.25in;mso-list:l24 level1 lfo31;
tab-stops:list 1.25in'><![if !supportLists]>2.<span style='font:7.0pt "Times New Roman"'>&nbsp;&nbsp;&nbsp;&nbsp;&nbsp;
</span><![endif]>Call AESDecrypt() with that key.</p>

<p class=MsoNormal>Before describing the secure operations, we describe a
fundamental quantity, a <b>license(also known as eTicket).</b> The purpose of
the license, is as always, to permit a customer to play a certain content after
having paid for it. The content itself can be obtained at any time.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Description of licenses</h1>

<p class=MsoNormal>Licenses are issued by an authorized license server, meant
for a customer BB, and downloaded at a depot download station. The depot
download station itself is a BB, which is owned by the depot retailer. The two
types of BBs are clearly distinguished as <b>customer BB</b> and <b>download
station BB</b>. (The distinction is only conceptual, each can act as the other
under different circumstances). Licenses issued to a download station BB are
called <b>personalization licenses</b> and do not authorize a BB to play that
content, merely to personalize it for another customer who has paid for it.
Licenses issued to customer BBs are <b>playback licenses</b> that authorize a
BB to play the content. Playback licenses can only be obtained by paying for
content. Personalization licenses are issued to authorized depot retailers when
they download content. Both are identical except that a bit in the license
field identifies a playback permission and/or personalization permission.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Anatomy of a license</h1>

<p class=MsoNormal>The license contains two distinct parts when the customer
owns it. One part<b>, the server license</b>, comes from the license server.
The other part, <b>the key packet</b>, comes from the depot or download station
which delivered the content. Both are necessary in order to play the content. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>----Server license-------</p>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>ContentID<span
     style="mso-spacerun: yes">  </span>(unencrypted)</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Meta-data (unencrypted)</li>
 <ul type=circle>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l16 level2 lfo11;tab-stops:list 1.0in'>content-type </li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l16 level2 lfo11;tab-stops:list 1.0in'>content-size </li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l16 level2 lfo11;tab-stops:list 1.0in'>size allocated for
      state</li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l16 level2 lfo11;tab-stops:list 1.0in'>title </li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l16 level2 lfo11;tab-stops:list 1.0in'>author </li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l16 level2 lfo11;tab-stops:list 1.0in'>description </li>
  <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:
      auto;mso-list:l16 level2 lfo11;tab-stops:list 1.0in'>thumbnail image ??? </li>
 </ul>
</ul>


<div class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
margin-left:.5in'>

<hr size=2 width=200 style='width:150.0pt' align=left>

</div>

<span style='font-size:12.0pt;font-family:"Times New Roman";mso-fareast-font-family:
"Times New Roman";mso-ansi-language:EN-US;mso-fareast-language:EN-US;
mso-bidi-language:AR-SA'>

<ul type=disc>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>BBID (id of BB this license
     is valid for) </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Whether the following
     information is encrypted. </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>-------------------------encrypted
     content (encrypt by<span style="mso-spacerun: yes">  </span>BB public key)</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Content Decryption Key (or
     null if not encrypted)</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Content Signature (Hash
     over entire content) </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>AES initialization vector (initial
     128-bit assumption used to encrypt content this license refers to) </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Load address (if n64 game,
     we don't want to use the boot code in the first 4K - starting at 0x40 - of
     cartridge ROM. Our loading code must load to the same address that was
     specified in the ROM image's initial 4K segment) </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Boot length (number of
     bytes loaded at boot time) </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Whether boot code is
     compressed (Boolean)</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Boot Signature (Hash over
     content length loaded at boot) </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Re-encryption license or
     playback license</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>If re-encryption license,
     re-encryption key material (to help create random re-encryption key).</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>HW access rights </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Optional license server CRL
     (rare case when all previous licenses should be revoked)</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>________________________end
     of encrypted content</li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>Certificates (for
     validation to trusted root, license server certificate) </li>
 <li class=MsoNormal style='mso-margin-top-alt:auto;mso-margin-bottom-alt:auto;
     mso-list:l16 level1 lfo11;tab-stops:list .5in'>License server signature
     (ECDSASign(hash(license), server_pvt_key,…) </li>
</ul>

</span>

<p class=MsoNormal>________server license over</p>

<p class=MsoNormal>Key packet content</p>

<p class=MsoNormal>----------encrypted by BB public key</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Content ID </p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span>Re-encryption
key</p>

<p class=MsoNormal>_______end of encrypted content</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l26 level1 lfo12;tab-stops:list .5in'>Depot
     certificate (depot download station ID+ public key signed by license
     server) (See note below).</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Note: Along with the content and personalization license,
the server creates and downloads to the depot disk, the BB certificates, signed
by the license server. When the download station BB loads the personalization
license, it loads the download station certificates to be written to the memory
module. (These steps are all repeated in various places below).</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt'>Section 1:
Description of Primary Secure Operations<o:p></o:p></span></i></h1>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span></p>

<p class=MsoNormal style='margin-left:.25in'>The following description outlines
the use of the above primitives in each of the following operations:</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i>Secure Operation 1: Downloading and personalization of content<o:p></o:p></i></h1>

<p class=MsoNormal>This operation is invoked whenever content is downloaded
after a license purchase or whenever the customer goes to a depot to obtain
content for which he already has a license. </p>

<p class=MsoNormal><b>Where it happens</b>: download station BB.</p>

<p class=MsoNormal><b>Input Data Structures: </b>Playback<b> </b>license from
server, personalization license from disk, Encrypted Content in depot, depot
download BB certificate from disk, customer BB certificate in memory module.</p>

<p class=MsoNormal><b>Output: </b>Encrypted content (unique per BB) on memory
module, key packet on memory module, license on memory module.</p>

<p class=MsoNormal><b>Invoked: </b>When memory module is inserted into slot, it
…</p>

<p class=MsoNormal><b>Uses libraries/code: </b><span style="mso-spacerun:
yes"> </span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>Function
     call IsReEncryptionReq() to determine whether to proceed to personalize</li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>decryption
     engine driver, </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>AES
     encryption algorithm in security library, </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>ECDSA
     signature verification, (including SHA hash) </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>PKI
     decryption: ECDHSharedSecret(), AESDecrypt() and AESEncrypt()</li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>Function
     call to verify license</li>
</ul>

<p class=MsoNormal><b>Steps:<o:p></o:p></b></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Locate
     and load customer <b>playback license</b> from memory module from the file
     system information on license locations by browsing for content ID. (Load
     complete license including key packet if any, upto maximum size including
     key packet).<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Load
     certificate from customer BB, parse (read BBID) and verify signature,
     proceed if verifies (also check for CRL: described later).<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Parse
     unencrypted part of customer license and verify license server signature<b><o:p></o:p></b></li>
</ul>

<p class=MsoNormal>Verify that BBID in certificate = BBID in license</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l20 level1 lfo27;tab-stops:list .5in'>Load
     download station BB certificate from depot disk into memory<b>.<o:p></o:p></b></li>
</ul>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Load
     and parse <b>personalization license </b>in depot disk for same content
     ID. <b><o:p></o:p></b></li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Check
      signature, parse unencrypted content, verify BBID (wrt download station
      BB)<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Check
      if re-encryption is required for this content using IsReEncryptionReq()<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Decrypt
      encrypted part and parse (ECSharedKey (license-server-public-key in
      license, BB-private-key) followed by AESDecrypt)<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Obtain
      content hash and content key<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Load
      re-encryption key material and initialization vector for CBC<b><o:p></o:p></b></li>
 </ul>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Generate
     re-encryption key = fn(re-encryption key material)<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Check
     if key packet exists in playback license, if so, prepare to replace.<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Load
     content from depot disk<b>. <o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>For
     each block<b><o:p></o:p></b></li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Decrypt
      by content key AESDecrypt()<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Compute
      hash of block, save state for CBC, running hash calculation using sha-1()<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Re-encrypt
      using generated key, initialization vector/prev block AESEncrypt()<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l21 level2 lfo5;tab-stops:list 1.0in'>Write
      to memory module<b><o:p></o:p></b></li>
 </ul>
</ul>

<p class=MsoNormal style='margin-left:.75in'>Upto end of content</p>

<p class=MsoNormal style='margin-left:.75in'><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>If
     content hash is equal to hash of content in personalization license,
     prepare to write key packet<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Encrypt
     by public key in customer certificate<b><o:p></o:p></b></li>
</ul>

<ul style='margin-top:0in' type=disc>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'>ECDHSharedKey(ECPublicKey
      customer, ECPrivateKey downloadBB, DHSharedKey shkey)</li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'>EncryptSymmetric(message,
      DHSharedKey shkey, CipherObject ciphertext) <b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'>Append
      self (download station BB) certificate, loaded from depot disk.<b><o:p></o:p></b></li>
 </ul>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>Write
     playback license + key packet on memory module<b><o:p></o:p></b></li>
</ul>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i>Secure Operation 2: Loading the Browser Application<o:p></o:p></i></h1>

<p class=MsoNormal>This does not require personalization, and all customers’
browser apps are encrypted by the key embedded in the license which is
encrypted by the same key. This is to enable the browser application to work on
any BB.</p>

<p class=MsoNormal><b>Where it happens</b>: customer BB or Download station BB</p>

<p class=MsoNormal><b>Input Data Structures: </b>Playback<b> </b>license,
Encrypted Content in depot, depot download BB certificate from disk.</p>

<p class=MsoNormal><b>Invoked: </b>After power on, after bootstrap secure
kernel runs to load browser application (either in download BB or at home in
customer BB)</p>

<p class=MsoNormal><b>Uses libraries/code: </b><span style="mso-spacerun:
yes"> </span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>Function
     call IsReEncryptionReq() to determine whether to proceed to personalize</li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>decryption
     engine driver, </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>AES
     encryption algorithm in security library, </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>ECDSA
     signature verification, (including SHA hash) </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>PKI
     decryption: ECDHSharedSecret(), AESDecrypt() and AESEncrypt()</li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>Function
     call to verify license</li>
</ul>

<p class=MsoNormal><b>Steps:<o:p></o:p></b></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Load
     license from flash from the file system information on license locations<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Load
     and Parse license -&gt; License Data Structure, save hash etc. The browser
     license is encrypted by a key in secure app. The browser decryption key is
     in the license. <b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Load
     Content ID to identify browser app, decompress<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>If
     boot segment length is equal to length of content, no re-encryption is
     necessary. </li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>SHA-1(Content)<span
     style="mso-spacerun: yes">  </span>and verify if hash in license is
     correct</li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Setup
     hardware rights based on license</li>
 <li class=MsoNormal style='mso-list:l21 level1 lfo5;tab-stops:list .5in'>Exit
     secure mode</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i>Secure Operation 3: Content playback/launching<o:p></o:p></i></h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This refers to content already personalized, during loading
and playback or re-encrypted data</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><b>Where it happens</b>: In customer BB </p>

<p class=MsoNormal><b>Input Data Structures: </b>Playback<b> </b>license with
key packet from depot download station BB, Encrypted Content, customer BB
certificate.</p>

<p class=MsoNormal><b>Output: </b>Encrypted content (unique per BB) on memory
module, key packet on memory module, license on memory module.</p>

<p class=MsoNormal><b>Invoked: </b>When playback of content is launched from
browser</p>

<p class=MsoNormal><b>Uses libraries/code: </b><span style="mso-spacerun:
yes"> </span></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>decryption
     engine driver, </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>ECDSA
     signature verification, (including SHA hash) </li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>PKI
     decryption: ECDHSharedSecret(), AESDecrypt() and AESEncrypt()</li>
 <li class=MsoNormal style='mso-list:l22 level1 lfo2;tab-stops:list .5in'>Function
     call to verify license</li>
</ul>

<p class=MsoNormal><b>Steps:<o:p></o:p></b></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>Load
     license, ECSharedKey() and AESDecrypt()</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>Parse
     license and load key packet</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>InitAES(key,
     IV, , content pointer…)</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>Compute
     SHA-1(content, N bytes) (check hash of entire content but keep boot
     segment internally- do not reload)</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>Verify
     hash from license contents</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>If
     ok, proceed:</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>Set
     up hardware access rights</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>Set
     up<span style="mso-spacerun: yes">  </span>IV for decryption engine, and
     decrypt key packet to obtain key, set up.</li>
 <li class=MsoNormal style='mso-list:l4 level1 lfo10;tab-stops:list .5in'>Exit
     secure mode</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The following are secure operations involving communication
with the servers</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i>Secure Operation 4: Activation <o:p></o:p></i></h1>

<p class=MsoNormal>The purpose of activation is to </p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l9 level1 lfo19;tab-stops:list .5in'>Register
     in our key generation server a real transaction from a BB that has been
     sold and bind the sale to a (public key, BBID) record in the server
     database, thus authorizing it for future purchases</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo19;tab-stops:list .5in'>Bind
     the selling depot retailer to a sale of BB transaction by him (for
     tracking)</li>
 <li class=MsoNormal style='mso-list:l9 level1 lfo19;tab-stops:list .5in'>Deliver
     to a BB memory module the signed certificate corresponding to the BBID’s
     private key. </li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Note: the server at the chip manufacturer or our end,
generates private, public key pairs.<span style="mso-spacerun: yes">  </span>It
saves them with corresponding BBIDs. When it receives confirmation of the BBIDs
actually manufactured and tested, the server could destroy the private key and
create the certificate.<span style="mso-spacerun: yes">  </span>That ensures
that a live BB’s private key is not lurking on the server.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText>Inputs: <span style='font-weight:normal'>The </span>manufacturer
initialized<span style='font-weight:normal'> memory module, with secure kernel,
browser application license and browser application, and BBID from secure
kernel call.<o:p></o:p></span></p>

<p class=MsoBodyText>Outputs: <span style='font-weight:normal'>Server</span> <span
style='font-weight:normal'>side registration of the BB being activated to
receive content in future, BB certificate loaded to memory module<o:p></o:p></span></p>

<p class=MsoNormal><b>(Note: The message packets are in a separate protocol
document, this document only identifies messages by the contents, not to be
treated as final).<o:p></o:p></b></p>

<p class=MsoNormal>The following are the crypto operations to achieve
activation:</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>Depot
     and activation server exchange certificates (depot certificate, since we
     want to bind the sale to the depot we want to see his identification) are
     exchanged and an authenticated connection is established. (No encryption
     is needed, unless some other depot proprietary information is submitted to
     the server.)</li>
</ul>

<p class=MsoNormal>Using whatever connectivity is available, the depot queries,
or obtains the BBID calling<span style="mso-spacerun: yes"> 
</span>LookupBBID() (returns 32 bit word)</p>

<p class=MsoNormal><b>Alternatives for all following transactions:</b> If RSA
is used, use standard public key encryption, or if an encrypted channel is used
(like SSL session key), send without encryption.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>Depot
     communicates to the activation server </li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l10 level2 lfo20;tab-stops:list 1.0in'>Activation
      Request (message ID)</li>
  <li class=MsoNormal style='mso-list:l10 level2 lfo20;tab-stops:list 1.0in'>BBID</li>
  <li class=MsoNormal style='mso-list:l10 level2 lfo20;tab-stops:list 1.0in'>Depot
      ID</li>
 </ul>
</ul>

<p class=MsoNormal style='margin-left:.75in'>Encrypt above packet by server
public key (exchanged during authentication). The purpose of this is not
security, but some confidentiality, so that the world doesn’t know how many BBs
the retailer is selling. For all these transactions compute a single
ECDHSharedKey using depot-server key pairs and use AES.</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>Server
     communicates to depot the following response encrypted by BB public key</li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l10 level2 lfo20;tab-stops:list 1.0in'>Please
      sign this (message ID)</li>
  <li class=MsoNormal style='mso-list:l10 level2 lfo20;tab-stops:list 1.0in'>Depot
      ID + “is proud to announce the birth of<span style="mso-spacerun: yes"> 
      </span>“+ BBID + “of<span style="mso-spacerun: yes">  </span>description
      “+ 256 bit random </li>
 </ul>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>Depot
     forwards response to BB.<span style="mso-spacerun: yes">  </span>On
     receiving, parsing message ID, BB invokes ECDSASign(inputstring,
     signature). Returns to depot { Signature response ID, signature} </li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>Depot
     encrypts by activation server public key and forwards to server. (This
     encryption is only because it is the depot retailer’s confidential
     information, so he would prefer it not be sent in the clear).</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>At this
     time, optionally, the server could ask the depot if the BB would like to
     choose a name before the birth certificate is issued. The depot could
     respond with a numeric, or some kind of name.</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>Server
     verifies signed response, returns to depot {Activation Result (message
     ID), Response OK} encrypted by depot public key, + BB certificate
     (unencrypted).</li>
 <li class=MsoNormal style='mso-list:l10 level1 lfo20;tab-stops:list .5in'>Depot
     forwards certificate to BB to store in memory module</li>
</ul>

<p class=MsoNormal><b>Requirement for all the above steps: above
authentication, optional encryption for confidentiality of transaction<o:p></o:p></b></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Recovery (an operation that invokes the above activation)</h1>

<p class=MsoNormal>Recovery is treated as </p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l25 level1 lfo18;tab-stops:list .5in'>Initialization
     of memory module with secure kernel and browser app with license (this is
     common software for all customers)</li>
 <li class=MsoNormal style='mso-list:l25 level1 lfo18;tab-stops:list .5in'>Activation
     process as above which results in download of certificate (includes
     challenge-response authentication)</li>
 <li class=MsoNormal style='mso-list:l25 level1 lfo18;tab-stops:list .5in'>Restore
     licenses in authenticated state</li>
 <li class=MsoNormal style='mso-list:l25 level1 lfo18;tab-stops:list .5in'>Go
     to download station and download content as before</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i>Secure Operation 5: License generation and purchase<o:p></o:p></i></h1>

<p class=MsoNormal>This operation involves steps that happen in the depot
download station BB, the retailer console, and the server. First we describe
the process of server license generation when requested for a content license.
This is for playback licenses. A similar procedure happens for personalization
licenses. (This is merely a necessary sequence of steps, not an implementation
description). The actual steps in the BB during the transaction is described
last.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>At the license server: license generation</h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=circle>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>Server
     ECDSAVerify() to verify submitted BB certificate and extracts BBID, public
     key<span style="mso-spacerun: yes">  </span>from it</li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>It
     obtains content ID from request </li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>It
     looks up all content meta data</li>
</ul>

<p class=MsoNormal style='margin-left:.25in'>The following assumes a new key
pair each time, alternately, the same key pair can be used. It maybe a little
harder to crypt analyze with different keys since licenses are small amounts of
data.</p>

<ul style='margin-top:0in' type=circle>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>Uses
     GeneratePrivateKey(), GeneratePublicKey(), Validate() to obtain a new key
     pair for license transaction<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>Encrypt
     following material: key, hash, boot info, rights by using </li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>ECSharedKey(new_private_key,
     customer_public_key,…)</li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>AESEncrypt(packet,
     shared_key, license) (append a fixed length string of random data about
     256 bits in the beginning to randomize plaintext through the CBC chain).</li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>ECDSASign(license)</li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>Append
     certificate corresponding to new public key to license, signed by license
     server (called ephemeral license certificate)</li>
 <li class=MsoNormal style='mso-list:l2 level1 lfo14;tab-stops:list .5in'>Append
     license server certificate signed by trusted root</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>At the License Server -&gt; Depot connection (to obtain content to depot
cache)</h1>

<p class=MsoNormal>Depot is secured to the extent that it contains a smart card
like device containing its private key, and contains a signed certificate.</p>

<h2>Depot to Server connection</h2>

<ul style='margin-top:0in' type=circle>
 <li class=MsoNormal style='mso-list:l18 level1 lfo16;tab-stops:list .5in'>Two
     way authenticated, not necessary to encrypt</li>
 <li class=MsoNormal style='mso-list:l18 level1 lfo16;tab-stops:list .5in'>Some
     protocol to accomplish something like this (see protocol document: this
     may be part of a larger transaction)</li>
 <li class=MsoNormal style='mso-list:l18 level1 lfo16;tab-stops:list .5in'>Depot-&gt;Server
     Browse titles</li>
 <li class=MsoNormal style='mso-list:l18 level1 lfo16;tab-stops:list .5in'>Server-&gt;Depot
     Return list</li>
 <li class=MsoNormal style='mso-list:l18 level1 lfo16;tab-stops:list .5in'>Depot-&gt;Server
     content(s) selection</li>
</ul>

<p class=MsoNormal><i>This is how encrypted<span style="mso-spacerun: yes"> 
</span>personalization licenses are obtained:<o:p></o:p></i></p>

<ul style='margin-top:0in' type=circle>
 <li class=MsoNormal style='mso-list:l18 level1 lfo16;tab-stops:list .5in'>Server-&gt;Depot
     Encrypted content and personalization licenses.</li>
 <li class=MsoNormal style='mso-list:l18 level1 lfo16;tab-stops:list .5in'>Server-&gt;Depot
     Download station BBs certificates signed by the license server.</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Encrypted content is encrypted by keys embedded in the
personalization licenses, and personalization licenses are generated and
encrypted as above. This is why encryption is not necessary for the server-&gt;
depot connection. <b>But there is an authentication of depot required to make
sure only depot BBs get free “personalization licenses”.</b><span
style="mso-spacerun: yes">  </span>(Its not critical because re-encryption is
done only after checking for a valid playback license, this is only to prevent
some stolen download stations attached to unauthorized depots providing a
service and maybe charging customers).</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Finally, the Download BB to server transaction resulting in license
purchase</h1>

<p class=MsoNormal>Assumption is that the browser application (which runs in
any BB including download station) can </p>

<ul style='margin-top:0in' type=circle>
 <li class=MsoNormal style='mso-list:l6 level1 lfo15;tab-stops:list .5in'>Locate
     and read memory module contents</li>
 <li class=MsoNormal style='mso-list:l6 level1 lfo15;tab-stops:list .5in'>Parse
     content ID, in licenses (unencrypted data read)</li>
 <li class=MsoNormal style='mso-list:l6 level1 lfo15;tab-stops:list .5in'>Implement
     security protocol to establish secure connection between download station
     and server through the depot</li>
</ul>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal>The license purchase protocol includes a variety of
exchanges of “browsing and selection” nature. The particular transaction of
requesting the license and downloading it is only discussed here. The license
itself is encrypted by the server by the BB public key. The “personalization”
part is created during downloading of content. So the purpose of these crypto
operations in the depot download station is merely to ensure that the BB owner
is assured that what he receives is indeed what is good for his BB. We need to
ensure that we can confirm that to him since he has already paid for it and he
leaves with the license without a chance to verify it with his own BB.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><b>We need an authenticated connection between server
(license server) and depot</b>.<span style="mso-spacerun: yes">  </span>In
addition</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l30 level1 lfo24;tab-stops:list .5in'>The
     server sends a MAC key to the depot and the download station encrypted by
     depot public key (RSA) and BB public key (ECDH/AES) resp. (Alternatively
     the depot and BB download station could sign the messages to the server,
     which might include them attaching certificates with the messages.)</li>
</ul>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l0 level1 lfo21;tab-stops:list .5in'>Purchase
     request from depot: {CMD, BBID, TITLE}+ MAC, unencrypted</li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo21;tab-stops:list .5in'>Server
     verifies MAC. This is to ensure that the title that the person has
     requested goes through unchanged through our system</li>
 <li class=MsoNormal style='mso-list:l0 level1 lfo21;tab-stops:list .5in'>Return
     status, no encryption or MAC.</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>On the download station, we go through the “download
eticket” option only. The others do not require any form of security.</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l14 level1 lfo22;tab-stops:list .5in'>BB
     loads customer certificate from memory module and verifies it and prints
     “Are you “+ BB user name on screen, if there is a user name.</li>
 <li class=MsoNormal style='mso-list:l14 level1 lfo22;tab-stops:list .5in'>On
     confirmation, it reads BBID from the certificate and signs
     ECDSASign/MAC({content length, download e-ticket, title ID, BBID},
     download_BB_sign), attaches message + MAC and sends to depot. </li>
 <li class=MsoNormal style='mso-list:l14 level1 lfo22;tab-stops:list .5in'>The
     BB forwards to the depot the above packet which is forwarded to the server
     by the depot.</li>
 <li class=MsoNormal style='mso-list:l14 level1 lfo22;tab-stops:list .5in'>The
     server prepares the license on the request, after verifying the MAC or
     signature. </li>
 <li class=MsoNormal style='mso-list:l14 level1 lfo22;tab-stops:list .5in'>The
     downloaded license is passed through the download station BB which
     verifies the BBID (unencrypted) and checks signature (ECDSAVer(…)) on the
     license.</li>
</ul>

<p class=MsoNormal style='margin-left:.25in'>This ensures that the particular
BBID that is confirmed by the customer goes through to the server without
tampering. Which is turn ensures that any response license he receives will
play on his BB.</p>

<p class=MsoNormal>Alternatively: if SSL connection is used between depot and
server, and message integrity is assumed, only the BB to depot message
integrity needs to be taken care of. This can be done by signature or MAC as
mentioned before.</p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1><i><span style='font-size:14.0pt;mso-bidi-font-size:12.0pt'>Section 2:
Design of the security library and functions<o:p></o:p></span></i></h1>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Lowest level functions</h1>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'><b>BigInt
     library </b>Implements big integer arithmetic (not exposed)<b><o:p></o:p></b></li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'><b>F2M
     library </b>Multi precision binary finite field representation in
     polynomial basis, all operations modulo a fixed irreducible polynomial
     (not exposed).</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'><b>EC
     library </b>Point and curve representations and implementation of basic
     operations (not exposed)</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'><b>Conversion
     functions </b>Conversion from <b><o:p></o:p></b></li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'>Binary
      string to octet string</li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'>Octet
      string to large integer</li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'>Inverse
      of above </li>
 </ul>
</ul>

<p class=MsoNormal style='margin-left:.75in'>(above are considered not exposed
unless needed)</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'><b>DER
     encoding </b>of following content for transmission or communicating via
     protocols. In most cases it will adhere to standards, in other cases
     custom.<b> </b>This API will be exposed.<b><o:p></o:p></b></li>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DEREncodePubKey
      (</b>ECPublicKey, DERString<b>)<o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DEREncodePvtKey
      (</b>ECPrivateKey, DERString<b>)<o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DEREncodeSig
      (</b>ECDSASignature, DERString)<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DEREencodeCipherText
      (</b>AESCipherText<b>, </b>DERString<b>)<o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DERtoPublicKey(</b>DERString,
      ECPublicKey)<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DERtoPrivateKey(</b>DERString,
      ECPrivateKey)<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DERtoECDSA(</b>DERString,
      ECDSASignature)<b><o:p></o:p></b></li>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'><b>DERtoAESCipherText(</b>DERString,
      ECIESCipherText)<b><o:p></o:p></b></li>
 </ul>
</ul>

<p class=MsoNormal>There may be a higher level call to encode a certificate.</p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal style='margin-left:.25in;text-indent:.5in'><b>For debugging:<o:p></o:p></b></p>

<p class=MsoNormal><b><span style='mso-tab-count:2'>                        </span>DERtoHEXOutput(</b>DERString,
String) in readable form</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Elliptic curve Algorithm choices</h1>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>We
     will use a binary field GF(2^m) with field arithmetic implemented in terms
     of operations on bits. </li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>We
     will use a polynomial basis (as opposed to normal basis of above field)
     specified by an irreducible polynomial modulo 2, so a bit string (of 0s
     and 1s) a_m….a_0<span style="mso-spacerun: yes">  </span>represents the
     polynomial a_m t^m+…..a_0.</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>We
     will use a pseudorandom curve over GF(2^m) , generated via SHA-1 based
     method mentioned in ANSI X9.62 and IEEE 1363.</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>One
     or many of the curves NIST_B_163, NIST_B_233, NIST_B_283, NIST_B_409 or
     NIST_B_571 will be used as mentioned in the standard “Recommended Elliptic
     Curves for Federal Gov Use”</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>For
     signatures we will use ECDSA (IEEE 1363 and X9.62) with the above options</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>For
     public key encryption we will use EC-DH for computing a shared key, (IEEE
     1363) followed by 128 bit AES.</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Domain Parameter initialization</h1>

<p class=MsoNormal>Since we only use NIST recommended curves, we initialize the
Domain Parameters structure using </p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>InitDomainParams(NIST_B_163,
     ECDomainParameters dp);</li>
</ul>

<p class=MsoNormal>All the constants are defined as NIST_B_163 and will be
initialized.<span style="mso-spacerun: yes">  </span>They are:</p>

<ul style='margin-top:0in' type=disc>
 <ul style='margin-top:0in' type=circle>
  <li class=MsoNormal style='mso-list:l23 level2 lfo7;tab-stops:list 1.0in'>Degree,
      F2M elements a and b specifying the curve, generator point on the curve, order
      r, and k, a positive prime integer and an irreducible polynomial.</li>
 </ul>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>ValidateParams(dp);
     </li>
</ul>

<p class=MsoNormal>(May not be necessary if we don’t allow custom parameters).</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Generating keys</h1>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>GeneratePrivateKey(dp,
     random r, ECPrivateKey pvtk)</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>GeneratePublicKey(dp,
     pk, ECPublicKey pubk );</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>ValidateKeys(dp,
     pvtk, pubk);</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Generating signatures</h1>

<p class=MsoNormal>Functions for generating and verifying ECDSA signatures,
implicitly use SHA-1.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>GenerateECDSA(dp,
     ECPrivateKey pvtk,<span style="mso-spacerun: yes"> 
     </span>OctetStringToInteger(sha-1(message)),<span style="mso-spacerun:
     yes">  </span>ECDSASignature);</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>Boolean
     VerifyECDSA(dp, ECDSASignature, OctetStringToInteger(sha-1(message)));</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Encryption and Decryption (Public key)</h1>

<p class=MsoNormal>This operation uses ECDH in ANSI X9.63 to encrypt a block of
data using a public key and decrypt using a private key. (ElGamal is still a
possibility).</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>ECDHSharedKey(ECPublicKey
     pubkey, ECPrivateKey pvtkey, DHSharedKey shkey) (server side and client
     side function)</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>EncryptSymmetric(message,
     DHSharedKey shkey, CipherObject ciphertext) (exposed)</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>DecryptSymmetric(CipherObject
     ciphertext, DHSharedKey shkey, message)</li>
</ul>

<p class=MsoNormal>CipherObject has the (IV, ciphertext length, ciphertext)</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Encryption and decryption (symmetric)</h1>

<p class=MsoNormal>These function calls drive the AES hardware for decryption
and software AES encryption. This functionality is hardcoded in the secure
kernel, the AES decryption may be exposed for decrypting stored items on flash.</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>AESInit(KeySchedule,
     InitVector, AESObj)</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>AESKeyExpand(key,
     KeySchedule);</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>AESEncrypt(AESObj,
     input, output)</li>
 <li class=MsoNormal style='mso-list:l23 level1 lfo7;tab-stops:list .5in'>AESDecrypt(AESObj,
     output, input)</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<h1>Appendix 1: License server revocation on BB</h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The license server certificate contains (see flash uses doc
for more details)</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l19 level1 lfo25;tab-stops:list .5in'>Issuing
     Authority name</li>
 <li class=MsoNormal style='mso-list:l19 level1 lfo25;tab-stops:list .5in'>ID</li>
 <li class=MsoNormal style='mso-list:l19 level1 lfo25;tab-stops:list .5in'>Public<span
     style="mso-spacerun: yes">  </span>Key</li>
 <li class=MsoNormal style='mso-list:l19 level1 lfo25;tab-stops:list .5in'>Serial
     number</li>
 <li class=MsoNormal style='mso-list:l19 level1 lfo25;tab-stops:list .5in'>Sign
     by trusted root (the BB knows this)</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The CRL we use has the following format:</p>

<p class=MsoNormal>{</p>

<p class=MsoNormal>ver number &gt; 0</p>

<p class=MsoNormal>Certificate serial number /ID</p>

<p class=MsoNormal>Certificate serial number/ID</p>

<p class=MsoNormal>ID of license server<span style="mso-spacerun: yes"> 
</span>(?? Do we need Ids or only certificates)</p>

<p class=MsoNormal>Sign of CA</p>

<p class=MsoNormal>Certificate of CA (signed by trusted root)</p>

<p class=MsoNormal>}</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The BB internal flash state stores an increasing number
called Ver number. (This is to prevent against someone deleting it.</p>

<p class=MsoNormal>The license has a field that optionally contains a CRL. This
could be used to revoke former compromised license servers.<span
style="mso-spacerun: yes">  </span>When the license parser (secure code) sees
this field, it</p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l12 level1 lfo26;tab-stops:list .5in'>Saves
     the version number in internal flash and saves the {ver number +<span
     style="mso-spacerun: yes">  </span>CRL in external flash} signed by BB</li>
 <li class=MsoNormal style='mso-list:l12 level1 lfo26;tab-stops:list .5in'>When
     any license signature is checked with respect to a license server
     certificate, this number in flash is checked.<span style="mso-spacerun:
     yes">  </span>If greater than zero, the corresponding signed CRL from the
     flash is checked wrt to BB, and the attached certificate, verified wrt
     trusted root. </li>
 <li class=MsoNormal style='mso-list:l12 level1 lfo26;tab-stops:list .5in'>It
     is checked to see if the license server ID in the list matches current
     license server ID in the certificate. </li>
 <li class=MsoNormal style='mso-list:l12 level1 lfo26;tab-stops:list .5in'>If
     it is not found, it is considered valid. Otherwise the license is invalid.</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.25in'><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><b>Appendix 2:<o:p></o:p></b></p>

<p class=MsoNormal><b>Server infrastructure for security<o:p></o:p></b></p>

<p class=MsoNormal>The following server components are referred to in this
document. These names may only be conceptual, in order to accomplish the stated
functions, the actual design will be in a server document. All of these are
repeated from above in order to collect all server functionality in one place.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'><b>Key
     generation Server<o:p></o:p></b></li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>This server could be at the manufacturer or our own, and
could have online or batch communication with our central servers. This server
generates valid (BBID, priv_key, public key) triples and gathers information as
to whether a certain chip with a private key has been manufactured. It then
receives tracking information at the board manufacturer. This server could
generate certificates and store them for later use during activation.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'><b>License
     server <o:p></o:p></b></li>
</ul>

<p class=MsoNormal>The license server is responsible for most cryptographic
operations, it does the job of creating licenses for content, upon request,
using the steps mentioned above.<span style="mso-spacerun: yes">  </span>It
also issues personalization licenses when content delivery to the depot
happens.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'><b>Content
     server<o:p></o:p></b></li>
</ul>

<p class=MsoNormal>The content server is responsible for the encryption of
content in preparation for download to the depots. It transfers content to the
depots over an authenticated connection. </p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'><b>Download
     station BB server<o:p></o:p></b></li>
</ul>

<p class=MsoNormal>This may not be a distinct component, but this server is
responsible for keeping track of BBs associated with depots, used as download
stations. The BBs are bound to specific depots and they generate and distribute
personalization keys to the depots to be stored in their disks. They also
create signed certificates for the BBs to be stored in the depots (also in the
BB memory modules).</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'><b>Activation
     server<o:p></o:p></b></li>
</ul>

<p class=MsoNormal>The activation server should be capable of </p>

<ul style='margin-top:0in' type=disc>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'>Generating
     a random challenge for a BB requesting authentication</li>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'>Verifying
     signature (ECDSAVerify, since the BB is only capable of that function).</li>
 <li class=MsoNormal style='mso-list:l7 level1 lfo28;tab-stops:list .5in'>Forwarding
     a certificate if successful.</li>
</ul>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal><b>Appendix 3:<o:p></o:p></b></p>

<h1>Certificate authorities and their functions</h1>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>The root certificate is one that is trusted by our
application and is configured into our players- it is hardcoded in internal
flash in the chips. Starting from the root certificates the following chains
are constructed: </p>

<p class=MsoNormal><span style='font-family:Wingdings;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:
Wingdings'>à</span></span> means “signs”. So signature verification proceeds in
reverse order</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Root-<span style='font-family:Wingdings;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:
Wingdings'>à</span></span>Operational CA<span style='font-family:Wingdings;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span style='mso-char-type:
symbol;mso-symbol-font-family:Wingdings'>à</span></span><span
style="mso-spacerun: yes">  </span>license server certificate <span
style='font-family:Wingdings;mso-ascii-font-family:"Times New Roman";
mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;mso-symbol-font-family:
Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:Wingdings'>à</span></span>
ephemeral license certificate <span style='font-family:Wingdings;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:
Wingdings'>à</span></span> license</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Root <span style='font-family:Wingdings;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:
Wingdings'>à</span></span>Operational CA <span style='font-family:Wingdings;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span style='mso-char-type:
symbol;mso-symbol-font-family:Wingdings'>à</span></span> license server CRL</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Root <span style='font-family:Wingdings;mso-ascii-font-family:
"Times New Roman";mso-hansi-font-family:"Times New Roman";mso-char-type:symbol;
mso-symbol-font-family:Wingdings'><span style='mso-char-type:symbol;mso-symbol-font-family:
Wingdings'>à</span></span>Operational CA <span style='font-family:Wingdings;
mso-ascii-font-family:"Times New Roman";mso-hansi-font-family:"Times New Roman";
mso-char-type:symbol;mso-symbol-font-family:Wingdings'><span style='mso-char-type:
symbol;mso-symbol-font-family:Wingdings'>à</span></span> content ID RL</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal>Similar hierarchies will be used at the server to protect
other sensitive information like stored content keys, etc. The Operational CAs
will sign these other servers in different heirarchies.</p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoBodyText>Appendix 4:</p>

<p class=MsoNormal><b>Contents of internal flash<o:p></o:p></b></p>

<p class=MsoNormal><b>Read-Only storage<o:p></o:p></b></p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>BBID</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only </p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>32 bits</p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>BB private key</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>160 bits</p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Root<span style="mso-spacerun: yes">  </span>public key-ID</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>161+32 bits</p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Key for encrypting for self</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>128 bits</p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Persistent state key</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>128 bits</p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Secure software/browser license key</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>128 bits</p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Hash of secure kernel</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>160 bits</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b>Read-Write storage<o:p></o:p></b></p>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>License server revocation ver number , CRC</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>R/W</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>32 + 32 bits</p>
  </td>
 </tr>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>License revocation list ver number</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>R/W</p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>32 bits</p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b>ROM contents<o:p></o:p></b></p>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=200 valign=top style='width:149.85pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Decryption driver, </p>
  <p class=MsoNormal>SHA-1 calculation</p>
  <p class=MsoNormal>Boot loader software</p>
  </td>
  <td width=208 valign=top style='width:156.1pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal>Read Only <b>(in ROM)</b></p>
  </td>
  <td width=182 valign=top style='width:136.85pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>&lt;= 32Kbytes<o:p></o:p></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b>Appendix 5:<o:p></o:p></b></p>

<p class=MsoNormal><b>Contents of certificate on BB<o:p></o:p></b></p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b>Content of certificate <o:p></o:p></b></p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b>Certificate = {<o:p></o:p></b></p>

<p class=MsoNormal style='text-indent:.5in'><b>Sequence ={<o:p></o:p></b></p>

<h1><span style='mso-tab-count:1'>            </span>Version = <span
style='font-weight:normal'>uint16<o:p></o:p></span></h1>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span><b>Serial
number = </b>uint32</p>

<p class=MsoNormal><b><span style='mso-tab-count:1'>            </span>SignatureAlgorithm
= </b>uchar8 //identifier</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span><b>Issuer =
</b>uchar8x8 //name</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span><b>Validity
= //</b>optional</p>

<p class=MsoNormal><b><span style='mso-tab-count:1'>            </span>Subject
= </b>uint16 //server identifier</p>

<p class=MsoNormal><span style='mso-tab-count:1'>            </span><b>SubjectPublicKeyInfo
= {<o:p></o:p></b></p>

<p class=MsoNormal><b><span style='mso-tab-count:2'>                        </span>Algorithm
= </b>uchar8 (EC-ElGamal identifier)</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span><b>Parameters</b>
=<span style="mso-spacerun: yes">  </span>{</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span><b>FieldID</b>
= uchar8 (prime or characteristic-two)</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span><b>Curve
</b>=<span style="mso-spacerun: yes">  </span>(a,b)</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span><b>BasePoint
= </b>(a)</p>

<p class=MsoNormal><span style='mso-tab-count:3'>                                    </span><b>Order
</b>=<span style="mso-spacerun: yes">  </span>int16</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span>}</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span><b>PublicKeyString
</b>= uint32*6 (161 bits)<span style='mso-tab-count:2'>                        </span></p>

<p class=MsoNormal style='text-indent:.5in'><b>}<o:p></o:p></b></p>

<p class=MsoNormal><b><span style='mso-tab-count:1'>            </span>Signature{<o:p></o:p></b></p>

<p class=MsoNormal><b><span style='mso-tab-count:2'>                        </span>Algorithm
= </b>uchar8 (ECDSA identifier)</p>

<p class=MsoNormal><span style='mso-tab-count:2'>                        </span><b>Parameters
= { } //if not same as above<o:p></o:p></b></p>

<p class=MsoNormal style='margin-left:.5in;text-indent:.5in'><b>ECDSA(Sequence)
= signature_value{r,s}<o:p></o:p></b></p>

<p class=MsoNormal style='text-indent:.5in'><b>}<o:p></o:p></b></p>

<p class=MsoNormal><b><span style='mso-tab-count:1'>            </span>Optional{<o:p></o:p></b></p>

<p class=MsoNormal><b><span style='mso-tab-count:1'>            </span>//hook
for other types<o:p></o:p></b></p>

<p class=MsoNormal><b><span style='mso-tab-count:1'>            </span>}<o:p></o:p></b></p>

<p class=MsoNormal><b>}<o:p></o:p></b></p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b>Appendix 6:<o:p></o:p></b></p>

<p class=MsoNormal><b>Revise for nearly 256 bit ECC (TBD)<o:p></o:p></b></p>

<p class=MsoNormal><b>Sizes for ECC <o:p></o:p></b></p>

<table border=1 cellspacing=0 cellpadding=0 style='border-collapse:collapse;
 border:none;mso-border-alt:solid windowtext .5pt;mso-padding-alt:0in 5.4pt 0in 5.4pt'>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>Public key<o:p></o:p></b></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-left:none;mso-border-left-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>161 bits<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>Private key<o:p></o:p></b></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>160 bits<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>ECDSA signature<o:p></o:p></b></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>322<span style="mso-spacerun: yes">  </span>bits<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>Short certificate (Certicom std)<o:p></o:p></b></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>62 bytes or 496 bits<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>ECDSA system parameters<o:p></o:p></b></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>481 bits<o:p></o:p></b></p>
  </td>
 </tr>
 <tr>
  <td width=295 valign=top style='width:221.4pt;border:solid windowtext .5pt;
  border-top:none;mso-border-top-alt:solid windowtext .5pt;padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>ECC public key parameters<o:p></o:p></b></p>
  </td>
  <td width=295 valign=top style='width:221.4pt;border-top:none;border-left:
  none;border-bottom:solid windowtext .5pt;border-right:solid windowtext .5pt;
  mso-border-top-alt:solid windowtext .5pt;mso-border-left-alt:solid windowtext .5pt;
  padding:0in 5.4pt 0in 5.4pt'>
  <p class=MsoNormal><b>24 bytes (could be hardcoded)<o:p></o:p></b></p>
  </td>
 </tr>
</table>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><b><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></b></p>

<p class=MsoNormal><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

<p class=MsoNormal style='margin-left:.25in'><![if !supportEmptyParas]>&nbsp;<![endif]><o:p></o:p></p>

</div>

</body>

</html>
